{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/Hijack/arrMethods.js","../../src/Hijack/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n    return typeof data === 'object' && data !== null;\r\n}","// 重写 数组的方法\r\nlet oldArrF = Array.prototype;\r\n\r\nconst newArrF = Object.create(oldArrF);\r\nconst F = [\r\n    'push',\r\n    'shift'\r\n]\r\nF.forEach(key=>{\r\n    newArrF[key] = function(...args){\r\n        if(key === 'push'){\r\n            console.log('调用了psuh')\r\n            //防止添加的属性是一个对象\r\n            this.__ob__.walk(args[0]);\r\n        }\r\n        // 依次对其他方法进行重写\r\n        oldArrF[key].apply(this,args);\r\n    }\r\n})\r\nexport default newArrF;","\r\nimport { isObject } from '../utils/index';\r\nimport arrMethods from './arrMethods';\r\n\r\nexport class Hijack{ //数据劫持\r\n    constructor(data){\r\n        if(!isObject(data)) throw new TypeError(\"data 的值必须是一个对象!\");\r\n        this.walk(data);\r\n    }\r\n    walk(data){\r\n        //区分数组和对象\r\n        if(Array.isArray(data)){\r\n            //将walk传给数组，等数组push... 可能会调用\r\n            data.__ob__ = this;\r\n            // 重写数组的 push shift unshift ....\r\n            data.__proto__ = arrMethods;\r\n            data.forEach(item=>{\r\n                this.walk(item);\r\n            })\r\n        }else{\r\n            //如果是对象才观察\r\n            if(data && (typeof data) == 'object'){\r\n                for(let key in data){\r\n                    this.defineRecative(data,key,data[key]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    defineRecative(data,key,value){\r\n        let _this = this;\r\n        //递归对 对象 实现深度观察\r\n        this.walk(value);\r\n        // let dep = new Beobserver();\r\n        //观察对象属性\r\n        Object.defineProperty(data,key,{\r\n            get(){\r\n                // Beobserver.target && dep.subscribe(Beobserver.target);\r\n                return value;\r\n            },\r\n            set:(newVal)=>{\r\n                if(value != newVal){\r\n                    //防止修改的值 是一个新对象\r\n                    this.walk(newVal);\r\n                    value = newVal;\r\n                    // dep.release();\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","import { Hijack } from './Hijack/index';\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    // 区分vue的数据来源 \r\n    if(opts.prpos){\r\n        initPrpos(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm);\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm);\r\n    }\r\n}\r\nfunction initPrpos(vm) {};\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm.$data = typeof data === 'function'? data.call(vm): data;\r\n    new Hijack(data);\r\n};\r\nfunction initMethods(vm) {};\r\nfunction initComputed(vm) {};","import { initState } from './state';\r\n\r\nfunction initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        this.$options = options;\r\n        initState(this);\r\n    }\r\n}\r\n\r\nexport default initMixin;","import initMixin from './init';\r\n\r\nfunction Vue(options) {\r\n    // console.log(options);\r\n    this._init(options);\r\n}\r\ninitMixin(Vue);\r\nexport default Vue;"],"names":["isObject","data","oldArrF","Array","prototype","newArrF","Object","create","F","forEach","key","args","console","log","__ob__","walk","apply","Hijack","TypeError","isArray","__proto__","arrMethods","item","defineRecative","value","defineProperty","get","set","newVal","initState","vm","opts","$options","prpos","initData","methods","computed","$data","call","initMixin","Vue","_init","options"],"mappings":"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"}