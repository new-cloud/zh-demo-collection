{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/Hijack/arrMethods.js","../../src/Hijack/index.js","../../src/state.js","../../src/compiler/index.js","../../src/compiler/PublishSubscribe.js","../../src/compiler/utils.js","../../src/compiler/compile.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n    return typeof data === 'object' && data !== null;\r\n}\r\n//判断传入的el 是否是一个元素节点\r\nexport function isElementNode(node) {\r\n    return node.nodeType === 1;\r\n}","// 重写 数组的方法\r\nlet oldArrF = Array.prototype;\r\n\r\nconst newArrF = Object.create(oldArrF);\r\nconst F = [\r\n    'push',\r\n    'shift'\r\n]\r\nF.forEach(key=>{\r\n    newArrF[key] = function(...args){\r\n        if(key === 'push'){\r\n            console.log('调用了psuh')\r\n            //防止添加的属性是一个对象\r\n            this.__ob__.walk(args[0]);\r\n        }\r\n        // 依次对其他方法进行重写\r\n        oldArrF[key].apply(this,args);\r\n    }\r\n})\r\nexport default newArrF;","\r\nimport { isObject } from '../utils/index';\r\nimport arrMethods from './arrMethods';\r\n\r\nexport class Hijack{ //数据劫持\r\n    constructor(data){\r\n        if(!isObject(data)) throw new TypeError(\"data 的值必须是一个对象!\");\r\n        this.walk(data);\r\n    }\r\n    walk(data){\r\n        //区分数组和对象\r\n        if(Array.isArray(data)){\r\n            //将walk传给数组，等数组push... 可能会调用\r\n            data.__ob__ = this;\r\n            // 重写数组的 push shift unshift ....\r\n            data.__proto__ = arrMethods;\r\n            data.forEach(item=>{\r\n                this.walk(item);\r\n            })\r\n        }else{\r\n            //如果是对象才观察\r\n            if(data && (typeof data) == 'object'){\r\n                for(let key in data){\r\n                    this.defineRecative(data,key,data[key]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    defineRecative(data,key,value){\r\n        let _this = this;\r\n        //递归对 对象 实现深度观察\r\n        this.walk(value);\r\n        // let dep = new Beobserver();\r\n        //观察对象属性\r\n        Object.defineProperty(data,key,{\r\n            get(){\r\n                // Beobserver.target && dep.subscribe(Beobserver.target);\r\n                return value;\r\n            },\r\n            set:(newVal)=>{\r\n                if(value != newVal){\r\n                    //防止修改的值 是一个新对象\r\n                    this.walk(newVal);\r\n                    value = newVal;\r\n                    // dep.release();\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","import { Hijack } from './Hijack/index';\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    // 区分vue的数据来源 \r\n    if(opts.prpos){\r\n        initPrpos(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm);\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm);\r\n    }\r\n}\r\nfunction initPrpos(vm) {};\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm.$data = typeof data === 'function'? data.call(vm): data;\r\n    new Hijack(data);\r\n};\r\nfunction initMethods(vm) {};\r\nfunction initComputed(vm) {};","// Regular Expressions for parsing tags and attributes\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\r\nconst startTagClose = /^\\s*(\\/?)>/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\nconst doctype = /^<!DOCTYPE [^>]+>/i\r\n\r\nfunction start(tagName, attrs){\r\n    console.log('开始标签:',tagName)\r\n    console.log('属性:',attrs)\r\n}\r\nfunction end(tagName) {\r\n    console.log('结束标签:', tagName);\r\n} \r\nfunction parseHTML(html) {\r\n    while(html){\r\n        let textEnd = html.indexOf('<');\r\n        if(textEnd === 0 ) {\r\n            let startTagMatch = parseStartTag();\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName,startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if(endTagMatch){\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n\r\n        }\r\n        let text;\r\n        if(textEnd >= 0){\r\n            text = html.substring(0,textEnd);\r\n        }\r\n        if(text){\r\n            advance(text.length);\r\n        }\r\n    }\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag(){\r\n        let start = html.match(startTagOpen);\r\n        let match;\r\n        if(start){\r\n            match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            };\r\n            advance(start[0].length);\r\n        }\r\n        let end,attr;\r\n        while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n            advance(attr[0].length);\r\n            match.attrs.push({\r\n                name: attr[1],\r\n                value: attr[3] || attr[4] || attr[5]\r\n            })\r\n        }\r\n        // console.log(html)\r\n        // console.log(match)\r\n        if(end){\r\n            advance(end[0].length);\r\n            return match;\r\n        }\r\n       \r\n    }\r\n}\r\n\r\nexport function compileToFn(template) {\r\n    let root = parseHTML(template);\r\n    return function render() {\r\n\r\n    }\r\n}","\r\nimport CompileUtils from './utils';\r\n\r\nclass Beobserver{\r\n    constructor(){\r\n        this.arr = [];\r\n    }\r\n    subscribe(observer) {\r\n        this.arr.push(observer);\r\n        console.log(this.arr)\r\n    }\r\n    release(){\r\n        this.arr.forEach(observer=>observer.update());\r\n    }\r\n}\r\nclass Observer{\r\n    constructor(vm,expr,cd){\r\n        this.vm = vm;\r\n        this.expr = expr;\r\n        this.cd = cd;\r\n        this.oldValue = this.get();\r\n    }\r\n    get(){\r\n        Beobserver.target = this;\r\n        let value = CompileUtils.getExpr(this.vm,this.expr);\r\n        Beobserver.target = null;\r\n        return value;\r\n    }\r\n    update(){\r\n        let newVal = CompileUtils.getExpr(this.vm,this.expr);\r\n        if(newVal != this.oldValue){\r\n            this.cd(newVal);\r\n        }\r\n    }\r\n}\r\nexport {\r\n    Beobserver,\r\n    Observer\r\n}","import { Observer } from './PublishSubscribe';\r\n\r\nexport default {\r\n    getExpr(vm,expr) {\r\n        return expr.split('.').reduce((data,key) => {\r\n            return data[key];\r\n        },vm.$data)\r\n    },\r\n    setVal(vm,expr,value){\r\n        expr.split('.').reduce((data,key,index,arr) => {\r\n            if(index === arr.length-1){\r\n                data[key] = value;\r\n            }\r\n            return data[key];\r\n        },vm.$data);\r\n    },\r\n    model(node,expr,vm){\r\n        let fn = this.updater.modelUpdater;\r\n        new Observer(vm,expr,(newVal)=>{\r\n            fn(node,newVal);\r\n        });\r\n        node.addEventListener('input',(e)=>{\r\n            let value = e.target.value;\r\n            this.setVal(vm,expr,value);\r\n        });\r\n        let value = this.getExpr(vm,expr);\r\n        fn(node,value);\r\n    },\r\n    on(node,expr,vm,eventName){\r\n        node.addEventListener(eventName,(e)=>{\r\n            vm[expr].call(vm,e);\r\n        })\r\n    },\r\n    html() {},\r\n    //...\r\n    getContentVal(vm,expr){\r\n        return expr.replace( /\\{\\{(.+?)\\}\\}/g, (...args) => {\r\n            return this.getExpr(vm,args[1]);\r\n        });\r\n    },\r\n    text(node,content,vm) {\r\n        let fn = this.updater.textUpdater;\r\n        let value = content.replace( /\\{\\{(.+?)\\}\\}/g, (...args) => {\r\n            new Observer(vm,args[1],()=>{\r\n                let vlaue2 = this.getContentVal(vm,content);\r\n                fn(node,vlaue2);\r\n            }); \r\n            return this.getExpr(vm,args[1]);\r\n        });\r\n        fn(node,value);\r\n    },\r\n    updater: {\r\n        modelUpdater(node,value) {\r\n            node.value = value;\r\n        },\r\n        htmlUpdater() {},\r\n        textUpdater(node,value) {\r\n            node.textContent = value;\r\n        }\r\n        //...\r\n    }\r\n}","import CompileUtils from './utils';\r\n\r\n// 基类  调度\r\nexport default class Compiler{\r\n    constructor(el,vm){\r\n        this.vm = vm;\r\n        let fragment = this.nodeFragment(el);\r\n        //编译模板\r\n        this.compile(fragment);\r\n        // this.el.appendChild(fragment);\r\n    }\r\n    isElementNode(node){\r\n        //判断传入的el 是否是一个元素节点\r\n        return node.nodeType === 1;\r\n    }\r\n    nodeFragment(node){\r\n        let fragment = document.createDocumentFragment();\r\n        let nodeChildl;\r\n        let nodearr = [...node.children];\r\n        for(let i in nodearr){\r\n            fragment.appendChild(nodearr[i]);\r\n        }\r\n        return fragment;\r\n    }\r\n    compile(template){  //编译文档片段中的dom节点\r\n        let childNodes = template.childNodes;\r\n        [...childNodes].forEach(item => {\r\n            if(this.isElementNode(item)){\r\n                this.compileElement(item);\r\n                //如果是元素的 把自己传进去 遍历子节点\r\n                this.compile(item);\r\n            }else{\r\n                this.compileText(item);\r\n            }\r\n        })\r\n    }\r\n    isDirective(attr){\r\n        //查看属性名 是否以 v- 开头\r\n        return attr.startsWith('v-');\r\n    }\r\n    //编译元素\r\n    compileElement(node){\r\n        let attrs = node.attributes;\r\n        [...attrs].forEach(item => {\r\n            let { name,value:expr } = item;\r\n            if(this.isDirective(name)){ //v-model v-html v-if\r\n                let [,dirctive] = name.split('-');\r\n                let [dirctiveName,eventName] = dirctive.split(':');\r\n                //根据传入的不同指令执行不同的方法\r\n                CompileUtils[dirctiveName](node,expr,this.vm,eventName);\r\n            }\r\n        })\r\n    }\r\n    //编译文本\r\n    compileText(node){\r\n        let content = node.textContent;\r\n        //如果文本内容是{{}}\r\n        if(/\\{\\{(.+?)}\\}/.test(content)){\r\n            CompileUtils.text(node,content,this.vm);\r\n        }\r\n    }\r\n}","import { initState } from './state';\r\nimport { isElementNode } from './utils/index';\r\nimport { compileToFn } from './compiler/index';\r\nimport compile from './compiler/compile';\r\n\r\nfunction initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        this.$options = options;\r\n        initState(this);\r\n        if(options.el){\r\n            let el = isElementNode(options.el)?options.el:document.querySelector(options.el);\r\n            // this.$mount(el);\r\n            new compile(el,this);\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        let template = options.template;\r\n        if(!template){\r\n            template = el.outerHTML;\r\n        }\r\n        let render = compileToFn(template);\r\n        \r\n    }\r\n}\r\n\r\nexport default initMixin;","import initMixin from './init';\r\n\r\nfunction Vue(options) {\r\n    // console.log(options);\r\n    this._init(options);\r\n}\r\ninitMixin(Vue);\r\nexport default Vue;"],"names":["isObject","data","isElementNode","node","nodeType","oldArrF","Array","prototype","newArrF","Object","create","F","forEach","key","args","console","log","__ob__","walk","apply","Hijack","TypeError","isArray","__proto__","arrMethods","item","defineRecative","value","defineProperty","get","set","newVal","initState","vm","opts","$options","prpos","initData","methods","computed","$data","call","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","start","tagName","attrs","end","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","length","text","substring","n","attr","push","name","compileToFn","template","root","render","Observer","expr","cd","oldValue","CompileUtils","getExpr","split","reduce","setVal","index","arr","model","fn","updater","modelUpdater","addEventListener","e","target","on","eventName","getContentVal","replace","content","textUpdater","vlaue2","htmlUpdater","textContent","Compiler","el","fragment","nodeFragment","compile","document","createDocumentFragment","nodearr","children","i","appendChild","childNodes","compileElement","compileText","startsWith","attributes","isDirective","dirctive","dirctiveName","test","initMixin","Vue","_init","options","querySelector","$mount","outerHTML"],"mappings":"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"}