{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/Hijack/arrMethods.js","../../src/compiler/utils.js","../../src/compiler/PublishSubscribe.js","../../src/Hijack/index.js","../../src/state.js","../../src/compiler/index.js","../../src/compiler/compile.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data) {\r\n    return typeof data === 'object' && data !== null;\r\n}\r\n//判断传入的el 是否是一个元素节点\r\nexport function isElementNode(node) {\r\n    return node.nodeType === 1;\r\n}","// 重写 数组的方法\r\nlet oldArrF = Array.prototype;\r\n\r\nconst newArrF = Object.create(oldArrF);\r\nconst F = [\r\n    'push',\r\n    'shift'\r\n]\r\nF.forEach(key=>{\r\n    newArrF[key] = function(...args){\r\n        if(key === 'push'){\r\n            console.log('调用了psuh')\r\n            //防止添加的属性是一个对象\r\n            this.__ob__.walk(args[0]);\r\n        }\r\n        // 依次对其他方法进行重写\r\n        oldArrF[key].apply(this,args);\r\n    }\r\n})\r\nexport default newArrF;","import { Observer } from './PublishSubscribe';\r\n\r\nexport default {\r\n    getExpr(vm,expr) {\r\n        return expr.split('.').reduce((data,key) => {\r\n            return data[key];\r\n        },vm.$data)\r\n    },\r\n    setVal(vm,expr,value){\r\n        expr.split('.').reduce((data,key,index,arr) => {\r\n            if(index === arr.length-1){\r\n                data[key] = value;\r\n            }\r\n            return data[key];\r\n        },vm.$data);\r\n    },\r\n    model(node,expr,vm){\r\n        let fn = this.updater.modelUpdater;\r\n        new Observer(vm,expr,(newVal)=>{\r\n            fn(node,newVal);\r\n        });\r\n        node.addEventListener('input',(e)=>{\r\n            let value = e.target.value;\r\n            this.setVal(vm,expr,value);\r\n        });\r\n        let value = this.getExpr(vm,expr);\r\n        fn(node,value);\r\n    },\r\n    on(node,expr,vm,eventName){\r\n        node.addEventListener(eventName,(e)=>{\r\n            vm[expr].call(vm,e);\r\n        })\r\n    },\r\n    html() {},\r\n    //...\r\n    getContentVal(vm,expr){\r\n        return expr.replace( /\\{\\{(.+?)\\}\\}/g, (...args) => {\r\n            return this.getExpr(vm,args[1]);\r\n        });\r\n    },\r\n    text(node,content,vm) {\r\n        let fn = this.updater.textUpdater;\r\n        let value = content.replace( /\\{\\{(.+?)\\}\\}/g, (...args) => {\r\n            new Observer(vm,args[1],()=>{\r\n                let vlaue2 = this.getContentVal(vm,content);\r\n                fn(node,vlaue2);\r\n            }); \r\n            return this.getExpr(vm,args[1]);\r\n        });\r\n        fn(node,value);\r\n    },\r\n    updater: {\r\n        modelUpdater(node,value) {\r\n            node.value = value;\r\n        },\r\n        htmlUpdater() {},\r\n        textUpdater(node,value) {\r\n            node.textContent = value;\r\n        }\r\n        //...\r\n    }\r\n}","\r\nimport CompileUtils from './utils';\r\n\r\nclass Beobserver{\r\n    constructor(){\r\n        this.arr = [];\r\n    }\r\n    subscribe(observer) {\r\n        this.arr.push(observer);\r\n    }\r\n    release(){\r\n        this.arr.forEach(observer=>observer.update());\r\n    }\r\n}\r\nclass Observer{\r\n    constructor(vm,expr,cd){\r\n        this.vm = vm;\r\n        this.expr = expr;\r\n        this.cd = cd;\r\n        this.oldValue = this.get();\r\n    }\r\n    get(){\r\n        Beobserver.target = this;\r\n        let value = CompileUtils.getExpr(this.vm,this.expr);\r\n        Beobserver.target = null;\r\n        return value;\r\n    }\r\n    update(){\r\n        let newVal = CompileUtils.getExpr(this.vm,this.expr);\r\n        if(newVal != this.oldValue){\r\n            this.cd(newVal);\r\n        }\r\n    }\r\n}\r\nexport {\r\n    Beobserver,\r\n    Observer\r\n}","\r\nimport { isObject } from '../utils/index';\r\nimport arrMethods from './arrMethods';\r\nimport { Beobserver } from '../compiler/PublishSubscribe';\r\n\r\n\r\nexport class Hijack{ //数据劫持\r\n    constructor(data){\r\n        console.log(data)\r\n        if(!isObject(data)) throw new TypeError(\"data 的值必须是一个对象!\");\r\n        this.walk(data);\r\n    }\r\n    walk(data){\r\n        //区分数组和对象\r\n        if(Array.isArray(data)){\r\n            //将walk传给数组，等数组push... 可能会调用\r\n            data.__ob__ = this;\r\n            // 重写数组的 push shift unshift ....\r\n            data.__proto__ = arrMethods;\r\n            data.forEach(item=>{\r\n                this.walk(item);\r\n            })\r\n        }else{\r\n            //如果是对象才观察\r\n            if(data && (typeof data) == 'object'){\r\n                for(let key in data){\r\n                    this.defineRecative(data,key,data[key]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    defineRecative(data,key,value){\r\n        let _this = this;\r\n        //递归对 对象 实现深度观察\r\n        this.walk(value);\r\n        let dep = new Beobserver();\r\n        //观察对象属性\r\n        Object.defineProperty(data,key,{\r\n            get(){\r\n                Beobserver.target && dep.subscribe(Beobserver.target);\r\n                return value;\r\n            },\r\n            set:(newVal)=>{\r\n                if(value != newVal){\r\n                    //防止修改的值 是一个新对象\r\n                    this.walk(newVal);\r\n                    value = newVal;\r\n                    dep.release();\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","import { Hijack } from './Hijack/index';\r\n\r\nfunction proxyVm(vm){\r\n    for(let key in vm.$data){\r\n        Object.defineProperty(vm,key,{\r\n            get:()=>{\r\n                //这里只是将最外层的值修改了返回值\r\n                //为什么 取对象多层嵌套里面的值还是返回正确\r\n                //因为JS取值是从外面开始取,\r\n                //比如 vm.form.input 是先去vm.form 在取vn.form返回值的 .input\r\n                //所以这里将最外面的form返回值修改后  就不用再修改form里每个值的返回值了\r\n                return vm.$data[key];\r\n            },\r\n            set:(newVal)=>{\r\n                vm.$data[key] = newVal;\r\n            }\r\n        })\r\n    }\r\n};\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    // 区分vue的数据来源 \r\n    if(opts.prpos){\r\n        initPrpos(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm);\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm);\r\n    }\r\n}\r\nfunction initPrpos(vm) {};\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm.$data = typeof data === 'function'? data.call(vm): data;\r\n    new Hijack(data);\r\n    //把数据获取操作 vm上的取值操作 都代理到 vm.$data\r\n    proxyVm(vm);\r\n};\r\nfunction initMethods(vm) {\r\n    //实例方法\r\n    let methods = vm.$options.methods;\r\n    for(let key in methods){\r\n        Object.defineProperty(vm,key,{\r\n            get:()=>{\r\n                return methods[key];\r\n            }\r\n        })  \r\n    }\r\n};\r\nfunction initComputed(vm) {\r\n    //计算属性\r\n    let computed = vm.$options.computed;\r\n    for(let key in computed){\r\n        Object.defineProperty(vm.$data,key,{\r\n            get:()=>{\r\n                return computed[key].call(vm);\r\n            }\r\n        })\r\n    }\r\n};","// Regular Expressions for parsing tags and attributes\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\r\nconst startTagClose = /^\\s*(\\/?)>/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\nconst doctype = /^<!DOCTYPE [^>]+>/i\r\n\r\nfunction start(tagName, attrs){\r\n    console.log('开始标签:',tagName)\r\n    console.log('属性:',attrs)\r\n}\r\nfunction end(tagName) {\r\n    console.log('结束标签:', tagName);\r\n} \r\nfunction parseHTML(html) {\r\n    while(html){\r\n        let textEnd = html.indexOf('<');\r\n        if(textEnd === 0 ) {\r\n            let startTagMatch = parseStartTag();\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName,startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if(endTagMatch){\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n\r\n        }\r\n        let text;\r\n        if(textEnd >= 0){\r\n            text = html.substring(0,textEnd);\r\n        }\r\n        if(text){\r\n            advance(text.length);\r\n        }\r\n    }\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag(){\r\n        let start = html.match(startTagOpen);\r\n        let match;\r\n        if(start){\r\n            match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            };\r\n            advance(start[0].length);\r\n        }\r\n        let end,attr;\r\n        while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n            advance(attr[0].length);\r\n            match.attrs.push({\r\n                name: attr[1],\r\n                value: attr[3] || attr[4] || attr[5]\r\n            })\r\n        }\r\n        // console.log(html)\r\n        // console.log(match)\r\n        if(end){\r\n            advance(end[0].length);\r\n            return match;\r\n        }\r\n       \r\n    }\r\n}\r\n\r\nexport function compileToFn(template) {\r\n    let root = parseHTML(template);\r\n    return function render() {\r\n\r\n    }\r\n}","import CompileUtils from './utils';\r\n\r\n// 基类  调度\r\nexport default class Compiler{\r\n    constructor(el,vm){\r\n        this.vm = vm;\r\n        let fragment = this.nodeFragment(el);\r\n        //编译模板\r\n        this.compile(fragment);\r\n        el.appendChild(fragment);\r\n    }\r\n    isElementNode(node){\r\n        //判断传入的el 是否是一个元素节点\r\n        return node.nodeType === 1;\r\n    }\r\n    nodeFragment(node){\r\n        let fragment = document.createDocumentFragment();\r\n        let nodeChildl;\r\n        let nodearr = [...node.children];\r\n        for(let i in nodearr){\r\n            fragment.appendChild(nodearr[i]);\r\n        }\r\n        return fragment;\r\n    }\r\n    compile(template){  //编译文档片段中的dom节点\r\n        let childNodes = template.childNodes;\r\n        [...childNodes].forEach(item => {\r\n            if(this.isElementNode(item)){\r\n                this.compileElement(item);\r\n                //如果是元素的 把自己传进去 遍历子节点\r\n                this.compile(item);\r\n            }else{\r\n                this.compileText(item);\r\n            }\r\n        })\r\n    }\r\n    isDirective(attr){\r\n        //查看属性名 是否以 v- 开头\r\n        return attr.startsWith('v-');\r\n    }\r\n    //编译元素\r\n    compileElement(node){\r\n        let attrs = node.attributes;\r\n        [...attrs].forEach(item => {\r\n            let { name,value:expr } = item;\r\n            if(this.isDirective(name)){ //v-model v-html v-if\r\n                let [,dirctive] = name.split('-');\r\n                let [dirctiveName,eventName] = dirctive.split(':');\r\n                //根据传入的不同指令执行不同的方法\r\n                CompileUtils[dirctiveName](node,expr,this.vm,eventName);\r\n            }\r\n        })\r\n    }\r\n    //编译文本\r\n    compileText(node){\r\n        let content = node.textContent;\r\n        //如果文本内容是{{}}\r\n        if(/\\{\\{(.+?)}\\}/.test(content)){\r\n            CompileUtils.text(node,content,this.vm);\r\n        }\r\n    }\r\n}","import { initState } from './state';\r\nimport { isElementNode } from './utils/index';\r\nimport { compileToFn } from './compiler/index';\r\nimport compile from './compiler/compile';\r\n\r\nfunction initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        this.$options = options;\r\n        initState(this);\r\n        if(options.el){\r\n            let el = isElementNode(options.el)?options.el:document.querySelector(options.el);\r\n            // this.$mount(el);\r\n            new compile(el,this);\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        let template = options.template;\r\n        if(!template){\r\n            template = el.outerHTML;\r\n        }\r\n        let render = compileToFn(template);\r\n        \r\n    }\r\n}\r\n\r\nexport default initMixin;","import initMixin from './init';\r\n\r\nfunction Vue(options) {\r\n    // console.log(options);\r\n    this._init(options);\r\n}\r\ninitMixin(Vue);\r\nexport default Vue;"],"names":["isObject","data","isElementNode","node","nodeType","oldArrF","Array","prototype","newArrF","Object","create","F","forEach","key","args","console","log","__ob__","walk","apply","getExpr","vm","expr","split","reduce","$data","setVal","value","index","arr","length","model","fn","updater","modelUpdater","Observer","newVal","addEventListener","e","target","on","eventName","call","html","getContentVal","replace","text","content","textUpdater","vlaue2","htmlUpdater","textContent","Beobserver","observer","push","update","cd","oldValue","get","CompileUtils","Hijack","TypeError","isArray","__proto__","arrMethods","item","defineRecative","dep","defineProperty","subscribe","set","release","proxyVm","initState","opts","$options","prpos","initData","methods","initMethods","computed","initComputed","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","start","tagName","attrs","end","parseHTML","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","compileToFn","template","root","render","Compiler","el","fragment","nodeFragment","compile","appendChild","document","createDocumentFragment","nodearr","children","i","childNodes","compileElement","compileText","startsWith","attributes","isDirective","dirctive","dirctiveName","test","initMixin","Vue","_init","options","querySelector","$mount","outerHTML"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,QAAT,CAAkBC,IAAlB,EAAwB;EAC3B,SAAO,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAA5C;EACH;;EAEM,SAASC,aAAT,CAAuBC,IAAvB,EAA6B;EAChC,SAAOA,IAAI,CAACC,QAAL,KAAkB,CAAzB;EACH;;ECND;EACA,IAAIC,OAAO,GAAGC,KAAK,CAACC,SAApB;EAEA,IAAMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAcL,OAAd,CAAhB;EACA,IAAMM,CAAC,GAAG,CACN,MADM,EAEN,OAFM,CAAV;EAIAA,CAAC,CAACC,OAAF,CAAU,UAAAC,GAAG,EAAE;EACXL,EAAAA,OAAO,CAACK,GAAD,CAAP,GAAe,YAAiB;EAAA,sCAALC,IAAK;EAALA,MAAAA,IAAK;EAAA;;EAC5B,QAAGD,GAAG,KAAK,MAAX,EAAkB;EACdE,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EADc;;EAGd,WAAKC,MAAL,CAAYC,IAAZ,CAAiBJ,IAAI,CAAC,CAAD,CAArB;EACH,KAL2B;;;EAO5BT,IAAAA,OAAO,CAACQ,GAAD,CAAP,CAAaM,KAAb,CAAmB,IAAnB,EAAwBL,IAAxB;EACH,GARD;EASH,CAVD;;ACNA,qBAAe;EACXM,EAAAA,OADW,mBACHC,EADG,EACAC,IADA,EACM;EACb,WAAOA,IAAI,CAACC,KAAL,CAAW,GAAX,EAAgBC,MAAhB,CAAuB,UAACvB,IAAD,EAAMY,GAAN,EAAc;EACxC,aAAOZ,IAAI,CAACY,GAAD,CAAX;EACH,KAFM,EAELQ,EAAE,CAACI,KAFE,CAAP;EAGH,GALU;EAMXC,EAAAA,MANW,kBAMJL,EANI,EAMDC,IANC,EAMIK,KANJ,EAMU;EACjBL,IAAAA,IAAI,CAACC,KAAL,CAAW,GAAX,EAAgBC,MAAhB,CAAuB,UAACvB,IAAD,EAAMY,GAAN,EAAUe,KAAV,EAAgBC,GAAhB,EAAwB;EAC3C,UAAGD,KAAK,KAAKC,GAAG,CAACC,MAAJ,GAAW,CAAxB,EAA0B;EACtB7B,QAAAA,IAAI,CAACY,GAAD,CAAJ,GAAYc,KAAZ;EACH;;EACD,aAAO1B,IAAI,CAACY,GAAD,CAAX;EACH,KALD,EAKEQ,EAAE,CAACI,KALL;EAMH,GAbU;EAcXM,EAAAA,KAdW,iBAcL5B,IAdK,EAcAmB,IAdA,EAcKD,EAdL,EAcQ;EAAA;;EACf,QAAIW,EAAE,GAAG,KAAKC,OAAL,CAAaC,YAAtB;EACA,QAAIC,QAAJ,CAAad,EAAb,EAAgBC,IAAhB,EAAqB,UAACc,MAAD,EAAU;EAC3BJ,MAAAA,EAAE,CAAC7B,IAAD,EAAMiC,MAAN,CAAF;EACH,KAFD;EAGAjC,IAAAA,IAAI,CAACkC,gBAAL,CAAsB,OAAtB,EAA8B,UAACC,CAAD,EAAK;EAC/B,UAAIX,KAAK,GAAGW,CAAC,CAACC,MAAF,CAASZ,KAArB;;EACA,MAAA,KAAI,CAACD,MAAL,CAAYL,EAAZ,EAAeC,IAAf,EAAoBK,KAApB;EACH,KAHD;EAIA,QAAIA,KAAK,GAAG,KAAKP,OAAL,CAAaC,EAAb,EAAgBC,IAAhB,CAAZ;EACAU,IAAAA,EAAE,CAAC7B,IAAD,EAAMwB,KAAN,CAAF;EACH,GAzBU;EA0BXa,EAAAA,EA1BW,cA0BRrC,IA1BQ,EA0BHmB,IA1BG,EA0BED,EA1BF,EA0BKoB,SA1BL,EA0Be;EACtBtC,IAAAA,IAAI,CAACkC,gBAAL,CAAsBI,SAAtB,EAAgC,UAACH,CAAD,EAAK;EACjCjB,MAAAA,EAAE,CAACC,IAAD,CAAF,CAASoB,IAAT,CAAcrB,EAAd,EAAiBiB,CAAjB;EACH,KAFD;EAGH,GA9BU;EA+BXK,EAAAA,IA/BW,kBA+BJ,EA/BI;EAgCX;EACAC,EAAAA,aAjCW,yBAiCGvB,EAjCH,EAiCMC,IAjCN,EAiCW;EAAA;;EAClB,WAAOA,IAAI,CAACuB,OAAL,CAAc,gBAAd,EAAgC,YAAa;EAChD,aAAO,MAAI,CAACzB,OAAL,CAAaC,EAAb,mDAAP;EACH,KAFM,CAAP;EAGH,GArCU;EAsCXyB,EAAAA,IAtCW,gBAsCN3C,IAtCM,EAsCD4C,OAtCC,EAsCO1B,EAtCP,EAsCW;EAAA;;EAClB,QAAIW,EAAE,GAAG,KAAKC,OAAL,CAAae,WAAtB;EACA,QAAIrB,KAAK,GAAGoB,OAAO,CAACF,OAAR,CAAiB,gBAAjB,EAAmC,YAAa;EACxD,UAAIV,QAAJ,CAAad,EAAb,oDAAwB,YAAI;EACxB,YAAI4B,MAAM,GAAG,MAAI,CAACL,aAAL,CAAmBvB,EAAnB,EAAsB0B,OAAtB,CAAb;;EACAf,QAAAA,EAAE,CAAC7B,IAAD,EAAM8C,MAAN,CAAF;EACH,OAHD;EAIA,aAAO,MAAI,CAAC7B,OAAL,CAAaC,EAAb,mDAAP;EACH,KANW,CAAZ;EAOAW,IAAAA,EAAE,CAAC7B,IAAD,EAAMwB,KAAN,CAAF;EACH,GAhDU;EAiDXM,EAAAA,OAAO,EAAE;EACLC,IAAAA,YADK,wBACQ/B,IADR,EACawB,KADb,EACoB;EACrBxB,MAAAA,IAAI,CAACwB,KAAL,GAAaA,KAAb;EACH,KAHI;EAILuB,IAAAA,WAJK,yBAIS,EAJT;EAKLF,IAAAA,WALK,uBAKO7C,IALP,EAKYwB,KALZ,EAKmB;EACpBxB,MAAAA,IAAI,CAACgD,WAAL,GAAmBxB,KAAnB;EACH,KAPI;;EAAA;EAjDE,CAAf;;MCCMyB;EACF,wBAAa;EAAA;;EACT,SAAKvB,GAAL,GAAW,EAAX;EACH;;;;gCACSwB,UAAU;EAChB,WAAKxB,GAAL,CAASyB,IAAT,CAAcD,QAAd;EACH;;;gCACQ;EACL,WAAKxB,GAAL,CAASjB,OAAT,CAAiB,UAAAyC,QAAQ;EAAA,eAAEA,QAAQ,CAACE,MAAT,EAAF;EAAA,OAAzB;EACH;;;;;;MAECpB;EACF,oBAAYd,EAAZ,EAAeC,IAAf,EAAoBkC,EAApB,EAAuB;EAAA;;EACnB,SAAKnC,EAAL,GAAUA,EAAV;EACA,SAAKC,IAAL,GAAYA,IAAZ;EACA,SAAKkC,EAAL,GAAUA,EAAV;EACA,SAAKC,QAAL,GAAgB,KAAKC,GAAL,EAAhB;EACH;;;;4BACI;EACDN,MAAAA,UAAU,CAACb,MAAX,GAAoB,IAApB;EACA,UAAIZ,KAAK,GAAGgC,YAAY,CAACvC,OAAb,CAAqB,KAAKC,EAA1B,EAA6B,KAAKC,IAAlC,CAAZ;EACA8B,MAAAA,UAAU,CAACb,MAAX,GAAoB,IAApB;EACA,aAAOZ,KAAP;EACH;;;+BACO;EACJ,UAAIS,MAAM,GAAGuB,YAAY,CAACvC,OAAb,CAAqB,KAAKC,EAA1B,EAA6B,KAAKC,IAAlC,CAAb;;EACA,UAAGc,MAAM,IAAI,KAAKqB,QAAlB,EAA2B;EACvB,aAAKD,EAAL,CAAQpB,MAAR;EACH;EACJ;;;;;;MC1BQwB,MAAb;EAAqB;EACjB,kBAAY3D,IAAZ,EAAiB;EAAA;;EACbc,IAAAA,OAAO,CAACC,GAAR,CAAYf,IAAZ;EACA,QAAG,CAACD,QAAQ,CAACC,IAAD,CAAZ,EAAoB,MAAM,IAAI4D,SAAJ,CAAc,iBAAd,CAAN;EACpB,SAAK3C,IAAL,CAAUjB,IAAV;EACH;;EALL;EAAA;EAAA,yBAMSA,IANT,EAMc;EAAA;;EACN;EACA,UAAGK,KAAK,CAACwD,OAAN,CAAc7D,IAAd,CAAH,EAAuB;EACnB;EACAA,QAAAA,IAAI,CAACgB,MAAL,GAAc,IAAd,CAFmB;;EAInBhB,QAAAA,IAAI,CAAC8D,SAAL,GAAiBC,OAAjB;EACA/D,QAAAA,IAAI,CAACW,OAAL,CAAa,UAAAqD,IAAI,EAAE;EACf,UAAA,MAAI,CAAC/C,IAAL,CAAU+C,IAAV;EACH,SAFD;EAGH,OARD,MAQK;EACD;EACA,YAAGhE,IAAI,IAAI,QAAQA,IAAR,KAAiB,QAA5B,EAAqC;EACjC,eAAI,IAAIY,GAAR,IAAeZ,IAAf,EAAoB;EAChB,iBAAKiE,cAAL,CAAoBjE,IAApB,EAAyBY,GAAzB,EAA6BZ,IAAI,CAACY,GAAD,CAAjC;EACH;EACJ;EACJ;EACJ;EAxBL;EAAA;EAAA,mCAyBmBZ,IAzBnB,EAyBwBY,GAzBxB,EAyB4Bc,KAzB5B,EAyBkC;EAAA;;;EAG1B,WAAKT,IAAL,CAAUS,KAAV;EACA,UAAIwC,GAAG,GAAG,IAAIf,UAAJ,EAAV,CAJ0B;;EAM1B3C,MAAAA,MAAM,CAAC2D,cAAP,CAAsBnE,IAAtB,EAA2BY,GAA3B,EAA+B;EAC3B6C,QAAAA,GAD2B,iBACtB;EACDN,UAAAA,UAAU,CAACb,MAAX,IAAqB4B,GAAG,CAACE,SAAJ,CAAcjB,UAAU,CAACb,MAAzB,CAArB;EACA,iBAAOZ,KAAP;EACH,SAJ0B;EAK3B2C,QAAAA,GAAG,EAAC,aAAClC,MAAD,EAAU;EACV,cAAGT,KAAK,IAAIS,MAAZ,EAAmB;EACf;EACA,YAAA,MAAI,CAAClB,IAAL,CAAUkB,MAAV;;EACAT,YAAAA,KAAK,GAAGS,MAAR;EACA+B,YAAAA,GAAG,CAACI,OAAJ;EACH;EACJ;EAZ0B,OAA/B;EAcH;EA7CL;;EAAA;EAAA;;ECJA,SAASC,OAAT,CAAiBnD,EAAjB,EAAoB;EAAA,6BACRR,GADQ;EAEZJ,IAAAA,MAAM,CAAC2D,cAAP,CAAsB/C,EAAtB,EAAyBR,GAAzB,EAA6B;EACzB6C,MAAAA,GAAG,EAAC,eAAI;EACJ;EACA;EACA;EACA;EACA;EACA,eAAOrC,EAAE,CAACI,KAAH,CAASZ,GAAT,CAAP;EACH,OARwB;EASzByD,MAAAA,GAAG,EAAC,aAAClC,MAAD,EAAU;EACVf,QAAAA,EAAE,CAACI,KAAH,CAASZ,GAAT,IAAgBuB,MAAhB;EACH;EAXwB,KAA7B;EAFY;;EAChB,OAAI,IAAIvB,GAAR,IAAeQ,EAAE,CAACI,KAAlB,EAAwB;EAAA,UAAhBZ,GAAgB;EAcvB;EACJ;EACM,SAAS4D,SAAT,CAAmBpD,EAAnB,EAAuB;EAC1B,MAAMqD,IAAI,GAAGrD,EAAE,CAACsD,QAAhB,CAD0B;;EAG1B,MAAGD,IAAI,CAACE,KAAR,EAAc;;EAGd,MAAGF,IAAI,CAACzE,IAAR,EAAa;EACT4E,IAAAA,QAAQ,CAACxD,EAAD,CAAR;EACH;;EACD,MAAGqD,IAAI,CAACI,OAAR,EAAgB;EACZC,IAAAA,WAAW,CAAC1D,EAAD,CAAX;EACH;;EACD,MAAGqD,IAAI,CAACM,QAAR,EAAiB;EACbC,IAAAA,YAAY,CAAC5D,EAAD,CAAZ;EACH;EACJ;;EAED,SAASwD,QAAT,CAAkBxD,EAAlB,EAAsB;EAClB,MAAIpB,IAAI,GAAGoB,EAAE,CAACsD,QAAH,CAAY1E,IAAvB;EACAA,EAAAA,IAAI,GAAGoB,EAAE,CAACI,KAAH,GAAW,OAAOxB,IAAP,KAAgB,UAAhB,GAA4BA,IAAI,CAACyC,IAAL,CAAUrB,EAAV,CAA5B,GAA2CpB,IAA7D;EACA,MAAI2D,MAAJ,CAAW3D,IAAX,EAHkB;;EAKlBuE,EAAAA,OAAO,CAACnD,EAAD,CAAP;EACH;;EACD,SAAS0D,WAAT,CAAqB1D,EAArB,EAAyB;EACrB;EACA,MAAIyD,OAAO,GAAGzD,EAAE,CAACsD,QAAH,CAAYG,OAA1B;;EAFqB,+BAGbjE,GAHa;EAIjBJ,IAAAA,MAAM,CAAC2D,cAAP,CAAsB/C,EAAtB,EAAyBR,GAAzB,EAA6B;EACzB6C,MAAAA,GAAG,EAAC,eAAI;EACJ,eAAOoB,OAAO,CAACjE,GAAD,CAAd;EACH;EAHwB,KAA7B;EAJiB;;EAGrB,OAAI,IAAIA,GAAR,IAAeiE,OAAf,EAAuB;EAAA,WAAfjE,GAAe;EAMtB;EACJ;;EACD,SAASoE,YAAT,CAAsB5D,EAAtB,EAA0B;EACtB;EACA,MAAI2D,QAAQ,GAAG3D,EAAE,CAACsD,QAAH,CAAYK,QAA3B;;EAFsB,+BAGdnE,GAHc;EAIlBJ,IAAAA,MAAM,CAAC2D,cAAP,CAAsB/C,EAAE,CAACI,KAAzB,EAA+BZ,GAA/B,EAAmC;EAC/B6C,MAAAA,GAAG,EAAC,eAAI;EACJ,eAAOsB,QAAQ,CAACnE,GAAD,CAAR,CAAc6B,IAAd,CAAmBrB,EAAnB,CAAP;EACH;EAH8B,KAAnC;EAJkB;;EAGtB,OAAI,IAAIR,GAAR,IAAemE,QAAf,EAAwB;EAAA,WAAhBnE,GAAgB;EAMvB;EACJ;;EChED;EACA,IAAMqE,SAAS,GAAG,2EAAlB;EAEA,IAAMC,MAAM,iCAAZ;EACA,IAAMC,YAAY,iBAAUD,MAAV,kBAAwBA,MAAxB,MAAlB;EACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,EAArB;EACA,IAAMG,aAAa,GAAG,YAAtB;EACA,IAAMC,MAAM,GAAG,IAAIF,MAAJ,gBAAmBF,YAAnB,YAAf;;EAGA,SAASK,KAAT,CAAeC,OAAf,EAAwBC,KAAxB,EAA8B;EAC1B5E,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAoB0E,OAApB;EACA3E,EAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkB2E,KAAlB;EACH;;EACD,SAASC,GAAT,CAAaF,OAAb,EAAsB;EAClB3E,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB0E,OAArB;EACH;;EACD,SAASG,SAAT,CAAmBlD,IAAnB,EAAyB;EACrB,SAAMA,IAAN,EAAW;EACP,QAAImD,OAAO,GAAGnD,IAAI,CAACoD,OAAL,CAAa,GAAb,CAAd;;EACA,QAAGD,OAAO,KAAK,CAAf,EAAmB;EACf,UAAIE,aAAa,GAAGC,aAAa,EAAjC;;EACA,UAAGD,aAAH,EAAiB;EACbP,QAAAA,KAAK,CAACO,aAAa,CAACN,OAAf,EAAuBM,aAAa,CAACL,KAArC,CAAL;EACA;EACH;;EACD,UAAIO,WAAW,GAAGvD,IAAI,CAACwD,KAAL,CAAWX,MAAX,CAAlB;;EACA,UAAGU,WAAH,EAAe;EACXE,QAAAA,OAAO,CAACF,WAAW,CAAC,CAAD,CAAX,CAAepE,MAAhB,CAAP;EACA8D,QAAAA,GAAG,CAACM,WAAW,CAAC,CAAD,CAAZ,CAAH;EACA;EACH;EAEJ;;EACD,QAAIpD,IAAI,SAAR;;EACA,QAAGgD,OAAO,IAAI,CAAd,EAAgB;EACZhD,MAAAA,IAAI,GAAGH,IAAI,CAAC0D,SAAL,CAAe,CAAf,EAAiBP,OAAjB,CAAP;EACH;;EACD,QAAGhD,IAAH,EAAQ;EACJsD,MAAAA,OAAO,CAACtD,IAAI,CAAChB,MAAN,CAAP;EACH;EACJ;;EACD,WAASsE,OAAT,CAAiBE,CAAjB,EAAoB;EAChB3D,IAAAA,IAAI,GAAGA,IAAI,CAAC0D,SAAL,CAAeC,CAAf,CAAP;EACH;;EACD,WAASL,aAAT,GAAwB;EACpB,QAAIR,KAAK,GAAG9C,IAAI,CAACwD,KAAL,CAAWd,YAAX,CAAZ;EACA,QAAIc,KAAJ;;EACA,QAAGV,KAAH,EAAS;EACLU,MAAAA,KAAK,GAAG;EACJT,QAAAA,OAAO,EAAED,KAAK,CAAC,CAAD,CADV;EAEJE,QAAAA,KAAK,EAAE;EAFH,OAAR;EAIAS,MAAAA,OAAO,CAACX,KAAK,CAAC,CAAD,CAAL,CAAS3D,MAAV,CAAP;EACH;;EACD,QAAI8D,GAAJ,EAAQW,IAAR;;EACA,WAAM,EAAEX,GAAG,GAAGjD,IAAI,CAACwD,KAAL,CAAWZ,aAAX,CAAR,MAAuCgB,IAAI,GAAG5D,IAAI,CAACwD,KAAL,CAAWjB,SAAX,CAA9C,CAAN,EAA4E;EACxEkB,MAAAA,OAAO,CAACG,IAAI,CAAC,CAAD,CAAJ,CAAQzE,MAAT,CAAP;EACAqE,MAAAA,KAAK,CAACR,KAAN,CAAYrC,IAAZ,CAAiB;EACbkD,QAAAA,IAAI,EAAED,IAAI,CAAC,CAAD,CADG;EAEb5E,QAAAA,KAAK,EAAE4E,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAf,IAAsBA,IAAI,CAAC,CAAD;EAFpB,OAAjB;EAIH,KAjBmB;EAmBpB;;;EACA,QAAGX,GAAH,EAAO;EACHQ,MAAAA,OAAO,CAACR,GAAG,CAAC,CAAD,CAAH,CAAO9D,MAAR,CAAP;EACA,aAAOqE,KAAP;EACH;EAEJ;EACJ;;EAEM,SAASM,WAAT,CAAqBC,QAArB,EAA+B;EAClC,MAAIC,IAAI,GAAGd,SAAS,CAACa,QAAD,CAApB;EACA,SAAO,SAASE,MAAT,GAAkB,EAAzB;EAGH;;MC3EoBC;EACjB,oBAAYC,EAAZ,EAAezF,EAAf,EAAkB;EAAA;;EACd,SAAKA,EAAL,GAAUA,EAAV;EACA,QAAI0F,QAAQ,GAAG,KAAKC,YAAL,CAAkBF,EAAlB,CAAf,CAFc;;EAId,SAAKG,OAAL,CAAaF,QAAb;EACAD,IAAAA,EAAE,CAACI,WAAH,CAAeH,QAAf;EACH;;;;oCACa5G,MAAK;EACf;EACA,aAAOA,IAAI,CAACC,QAAL,KAAkB,CAAzB;EACH;;;mCACYD,MAAK;EACd,UAAI4G,QAAQ,GAAGI,QAAQ,CAACC,sBAAT,EAAf;;EAEA,UAAIC,OAAO,sBAAOlH,IAAI,CAACmH,QAAZ,CAAX;;EACA,WAAI,IAAIC,CAAR,IAAaF,OAAb,EAAqB;EACjBN,QAAAA,QAAQ,CAACG,WAAT,CAAqBG,OAAO,CAACE,CAAD,CAA5B;EACH;;EACD,aAAOR,QAAP;EACH;;;8BACOL,UAAS;EAAA;;EAAG;EAChB,UAAIc,UAAU,GAAGd,QAAQ,CAACc,UAA1B;;EACA,yBAAIA,UAAJ,EAAgB5G,OAAhB,CAAwB,UAAAqD,IAAI,EAAI;EAC5B,YAAG,KAAI,CAAC/D,aAAL,CAAmB+D,IAAnB,CAAH,EAA4B;EACxB,UAAA,KAAI,CAACwD,cAAL,CAAoBxD,IAApB,EADwB;;;EAGxB,UAAA,KAAI,CAACgD,OAAL,CAAahD,IAAb;EACH,SAJD,MAIK;EACD,UAAA,KAAI,CAACyD,WAAL,CAAiBzD,IAAjB;EACH;EACJ,OARD;EASH;;;kCACWsC,MAAK;EACb;EACA,aAAOA,IAAI,CAACoB,UAAL,CAAgB,IAAhB,CAAP;EACH;;;;qCAEcxH,MAAK;EAAA;;EAChB,UAAIwF,KAAK,GAAGxF,IAAI,CAACyH,UAAjB;;EACA,yBAAIjC,KAAJ,EAAW/E,OAAX,CAAmB,UAAAqD,IAAI,EAAI;EAAA,YACjBuC,IADiB,GACGvC,IADH,CACjBuC,IADiB;EAAA,YACNlF,IADM,GACG2C,IADH,CACZtC,KADY;;EAEvB,YAAG,MAAI,CAACkG,WAAL,CAAiBrB,IAAjB,CAAH,EAA0B;EAAE;EAAF,4BACJA,IAAI,CAACjF,KAAL,CAAW,GAAX,CADI;EAAA;EAAA,cAChBuG,QADgB;;EAAA,gCAESA,QAAQ,CAACvG,KAAT,CAAe,GAAf,CAFT;EAAA;EAAA,cAEjBwG,YAFiB;EAAA,cAEJtF,SAFI;;;EAItBkB,UAAAA,YAAY,CAACoE,YAAD,CAAZ,CAA2B5H,IAA3B,EAAgCmB,IAAhC,EAAqC,MAAI,CAACD,EAA1C,EAA6CoB,SAA7C;EACH;EACJ,OARD;EASH;;;;kCAEWtC,MAAK;EACb,UAAI4C,OAAO,GAAG5C,IAAI,CAACgD,WAAnB,CADa;;EAGb,UAAG,eAAe6E,IAAf,CAAoBjF,OAApB,CAAH,EAAgC;EAC5BY,QAAAA,YAAY,CAACb,IAAb,CAAkB3C,IAAlB,EAAuB4C,OAAvB,EAA+B,KAAK1B,EAApC;EACH;EACJ;;;;;;ECvDL,SAAS4G,SAAT,CAAmBC,GAAnB,EAAuB;EACnBA,EAAAA,GAAG,CAAC3H,SAAJ,CAAc4H,KAAd,GAAsB,UAASC,OAAT,EAAiB;EACnC,SAAKzD,QAAL,GAAgByD,OAAhB;EACA3D,IAAAA,SAAS,CAAC,IAAD,CAAT;;EACA,QAAG2D,OAAO,CAACtB,EAAX,EAAc;EACV,UAAIA,EAAE,GAAG5G,aAAa,CAACkI,OAAO,CAACtB,EAAT,CAAb,GAA0BsB,OAAO,CAACtB,EAAlC,GAAqCK,QAAQ,CAACkB,aAAT,CAAuBD,OAAO,CAACtB,EAA/B,CAA9C,CADU;;EAGV,UAAIG,QAAJ,CAAYH,EAAZ,EAAe,IAAf;EACH;EACJ,GARD;;EASAoB,EAAAA,GAAG,CAAC3H,SAAJ,CAAc+H,MAAd,GAAuB,UAASxB,EAAT,EAAa;EAChC,QAAMzF,EAAE,GAAG,IAAX;EACA,QAAM+G,OAAO,GAAG/G,EAAE,CAACsD,QAAnB;EACA,QAAI+B,QAAQ,GAAG0B,OAAO,CAAC1B,QAAvB;;EACA,QAAG,CAACA,QAAJ,EAAa;EACTA,MAAAA,QAAQ,GAAGI,EAAE,CAACyB,SAAd;EACH;;EACD,QAAI3B,MAAM,GAAGH,WAAW,CAACC,QAAD,CAAxB;EAEH,GATD;EAUH;;ECvBD,SAASwB,GAAT,CAAaE,OAAb,EAAsB;EAClB;EACA,OAAKD,KAAL,CAAWC,OAAX;EACH;;EACDH,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}